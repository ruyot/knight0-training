================================================================================
NNUE-STYLE TRAINING - Dense Network (NOT CNN!)
================================================================================

Device: cpu

Loading data from training_data.pkl...
Using 10,000 positions

Train: 9,000 positions
Val:   1,000 positions

Model: 386,433 parameters (~1.5 MB)

Training for 30 epochs...

Epoch 1/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 1/30:   4%|▍         | 3/71 [00:00<00:02, 26.57it/s]Epoch 1/30:  11%|█▏        | 8/71 [00:00<00:01, 36.83it/s]Epoch 1/30:  18%|█▊        | 13/71 [00:00<00:01, 39.74it/s]Epoch 1/30:  25%|██▌       | 18/71 [00:00<00:01, 41.46it/s]Epoch 1/30:  32%|███▏      | 23/71 [00:00<00:01, 42.34it/s]Epoch 1/30:  39%|███▉      | 28/71 [00:00<00:00, 43.61it/s]Epoch 1/30:  46%|████▋     | 33/71 [00:00<00:00, 43.30it/s]Epoch 1/30:  54%|█████▎    | 38/71 [00:00<00:00, 45.04it/s]Epoch 1/30:  61%|██████    | 43/71 [00:01<00:00, 44.74it/s]Epoch 1/30:  68%|██████▊   | 48/71 [00:01<00:00, 45.29it/s]Epoch 1/30:  75%|███████▍  | 53/71 [00:01<00:00, 46.10it/s]Epoch 1/30:  82%|████████▏ | 58/71 [00:01<00:00, 43.84it/s]Epoch 1/30:  89%|████████▊ | 63/71 [00:01<00:00, 41.01it/s]Epoch 1/30:  96%|█████████▌| 68/71 [00:01<00:00, 39.96it/s]Epoch 1/30: 100%|██████████| 71/71 [00:01<00:00, 41.28it/s]
Epoch  1: train=0.3850, val=0.3369
  Testing:
    ✗ Start     : -0.800 (expect +0.0, error=0.800)
    ✗ White +Q  : -0.805 (expect +0.9, error=1.705)
    ✗ Equal     : -0.806 (expect +0.0, error=0.806)
    Variance: 0.0000 ⚠️  TOO LOW - not learning!
  → Saved (best_val=0.3369)

Epoch 2/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 2/30:   7%|▋         | 5/71 [00:00<00:01, 48.02it/s]Epoch 2/30:  14%|█▍        | 10/71 [00:00<00:01, 42.46it/s]Epoch 2/30:  21%|██        | 15/71 [00:00<00:01, 41.29it/s]Epoch 2/30:  28%|██▊       | 20/71 [00:00<00:01, 44.00it/s]Epoch 2/30:  35%|███▌      | 25/71 [00:00<00:01, 43.14it/s]Epoch 2/30:  42%|████▏     | 30/71 [00:00<00:00, 44.71it/s]Epoch 2/30:  49%|████▉     | 35/71 [00:00<00:00, 43.35it/s]Epoch 2/30:  56%|█████▋    | 40/71 [00:00<00:00, 43.46it/s]Epoch 2/30:  63%|██████▎   | 45/71 [00:01<00:00, 43.65it/s]Epoch 2/30:  70%|███████   | 50/71 [00:01<00:00, 43.19it/s]Epoch 2/30:  77%|███████▋  | 55/71 [00:01<00:00, 43.32it/s]Epoch 2/30:  85%|████████▍ | 60/71 [00:01<00:00, 43.36it/s]Epoch 2/30:  92%|█████████▏| 65/71 [00:01<00:00, 44.22it/s]Epoch 2/30:  99%|█████████▊| 70/71 [00:01<00:00, 43.18it/s]Epoch 2/30: 100%|██████████| 71/71 [00:01<00:00, 43.75it/s]
Epoch  2: train=0.3071, val=0.3172
  Testing:
    ✓ Start     : -0.215 (expect +0.0, error=0.215)
    ✗ White +Q  : -0.236 (expect +0.9, error=1.136)
    ✓ Equal     : -0.210 (expect +0.0, error=0.210)
    Variance: 0.0001 ⚠️  TOO LOW - not learning!
  → Saved (best_val=0.3172)

Epoch 3/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 3/30:   7%|▋         | 5/71 [00:00<00:01, 46.00it/s]Epoch 3/30:  14%|█▍        | 10/71 [00:00<00:01, 43.81it/s]Epoch 3/30:  21%|██        | 15/71 [00:00<00:01, 44.59it/s]Epoch 3/30:  28%|██▊       | 20/71 [00:00<00:01, 43.84it/s]Epoch 3/30:  35%|███▌      | 25/71 [00:00<00:01, 44.37it/s]Epoch 3/30:  42%|████▏     | 30/71 [00:00<00:00, 42.17it/s]Epoch 3/30:  49%|████▉     | 35/71 [00:01<00:01, 22.95it/s]Epoch 3/30:  56%|█████▋    | 40/71 [00:01<00:01, 27.22it/s]Epoch 3/30:  63%|██████▎   | 45/71 [00:01<00:00, 31.64it/s]Epoch 3/30:  70%|███████   | 50/71 [00:01<00:00, 34.21it/s]Epoch 3/30:  77%|███████▋  | 55/71 [00:01<00:00, 37.25it/s]Epoch 3/30:  85%|████████▍ | 60/71 [00:01<00:00, 37.96it/s]Epoch 3/30:  92%|█████████▏| 65/71 [00:01<00:00, 40.42it/s]Epoch 3/30:  99%|█████████▊| 70/71 [00:01<00:00, 41.17it/s]Epoch 3/30: 100%|██████████| 71/71 [00:01<00:00, 37.07it/s]
Epoch  3: train=0.2886, val=0.3279
  Testing:
    ✗ Start     : -0.571 (expect +0.0, error=0.571)
    ✗ White +Q  : -0.628 (expect +0.9, error=1.528)
    ✗ Equal     : -0.592 (expect +0.0, error=0.592)
    Variance: 0.0006 ⚠️  TOO LOW - not learning!
  → No improvement (1/5)

Epoch 4/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 4/30:   7%|▋         | 5/71 [00:00<00:01, 45.22it/s]Epoch 4/30:  14%|█▍        | 10/71 [00:00<00:01, 41.04it/s]Epoch 4/30:  21%|██        | 15/71 [00:00<00:01, 39.73it/s]Epoch 4/30:  27%|██▋       | 19/71 [00:00<00:01, 39.65it/s]Epoch 4/30:  32%|███▏      | 23/71 [00:00<00:01, 34.09it/s]Epoch 4/30:  38%|███▊      | 27/71 [00:00<00:01, 34.95it/s]Epoch 4/30:  44%|████▎     | 31/71 [00:00<00:01, 36.04it/s]Epoch 4/30:  51%|█████     | 36/71 [00:00<00:00, 37.54it/s]Epoch 4/30:  58%|█████▊    | 41/71 [00:01<00:00, 39.29it/s]Epoch 4/30:  65%|██████▍   | 46/71 [00:01<00:00, 41.05it/s]Epoch 4/30:  72%|███████▏  | 51/71 [00:01<00:00, 41.77it/s]Epoch 4/30:  79%|███████▉  | 56/71 [00:01<00:00, 42.18it/s]Epoch 4/30:  86%|████████▌ | 61/71 [00:01<00:00, 43.55it/s]Epoch 4/30:  93%|█████████▎| 66/71 [00:01<00:00, 44.10it/s]Epoch 4/30: 100%|██████████| 71/71 [00:01<00:00, 45.15it/s]Epoch 4/30: 100%|██████████| 71/71 [00:01<00:00, 40.87it/s]
Epoch  4: train=0.2818, val=0.3416
  Testing:
    ✗ Start     : -0.738 (expect +0.0, error=0.738)
    ✗ White +Q  : -0.761 (expect +0.9, error=1.661)
    ✗ Equal     : -0.734 (expect +0.0, error=0.734)
    Variance: 0.0001 ⚠️  TOO LOW - not learning!
  → No improvement (2/5)

Epoch 5/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 5/30:   7%|▋         | 5/71 [00:00<00:01, 42.43it/s]Epoch 5/30:  14%|█▍        | 10/71 [00:00<00:01, 42.65it/s]Epoch 5/30:  21%|██        | 15/71 [00:00<00:01, 44.78it/s]Epoch 5/30:  28%|██▊       | 20/71 [00:00<00:01, 44.02it/s]Epoch 5/30:  35%|███▌      | 25/71 [00:00<00:01, 44.85it/s]Epoch 5/30:  42%|████▏     | 30/71 [00:00<00:00, 43.37it/s]Epoch 5/30:  49%|████▉     | 35/71 [00:00<00:00, 44.35it/s]Epoch 5/30:  56%|█████▋    | 40/71 [00:00<00:00, 44.17it/s]Epoch 5/30:  63%|██████▎   | 45/71 [00:01<00:00, 42.97it/s]Epoch 5/30:  70%|███████   | 50/71 [00:01<00:00, 44.54it/s]Epoch 5/30:  77%|███████▋  | 55/71 [00:01<00:00, 43.65it/s]Epoch 5/30:  85%|████████▍ | 60/71 [00:01<00:00, 44.22it/s]Epoch 5/30:  92%|█████████▏| 65/71 [00:01<00:00, 41.49it/s]Epoch 5/30:  99%|█████████▊| 70/71 [00:01<00:00, 43.03it/s]Epoch 5/30: 100%|██████████| 71/71 [00:01<00:00, 43.74it/s]
Epoch  5: train=0.2674, val=0.3122
  Testing:
    ✗ Start     : -0.601 (expect +0.0, error=0.601)
    ✗ White +Q  : -0.655 (expect +0.9, error=1.555)
    ✗ Equal     : -0.606 (expect +0.0, error=0.606)
    Variance: 0.0006 ⚠️  TOO LOW - not learning!
  → Saved (best_val=0.3122)

Epoch 6/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 6/30:   4%|▍         | 3/71 [00:00<00:02, 27.91it/s]Epoch 6/30:  11%|█▏        | 8/71 [00:00<00:01, 39.92it/s]Epoch 6/30:  18%|█▊        | 13/71 [00:00<00:01, 43.46it/s]Epoch 6/30:  25%|██▌       | 18/71 [00:00<00:01, 44.32it/s]Epoch 6/30:  32%|███▏      | 23/71 [00:00<00:01, 43.24it/s]Epoch 6/30:  39%|███▉      | 28/71 [00:00<00:00, 44.85it/s]Epoch 6/30:  46%|████▋     | 33/71 [00:00<00:00, 44.29it/s]Epoch 6/30:  54%|█████▎    | 38/71 [00:00<00:00, 44.31it/s]Epoch 6/30:  61%|██████    | 43/71 [00:00<00:00, 43.80it/s]Epoch 6/30:  68%|██████▊   | 48/71 [00:01<00:00, 42.67it/s]Epoch 6/30:  75%|███████▍  | 53/71 [00:01<00:00, 43.65it/s]Epoch 6/30:  82%|████████▏ | 58/71 [00:01<00:00, 42.31it/s]Epoch 6/30:  89%|████████▊ | 63/71 [00:01<00:00, 43.68it/s]Epoch 6/30:  96%|█████████▌| 68/71 [00:01<00:00, 42.42it/s]Epoch 6/30: 100%|██████████| 71/71 [00:01<00:00, 43.37it/s]
Epoch  6: train=0.2553, val=0.3324
  Testing:
    ✗ Start     : -0.322 (expect +0.0, error=0.322)
    ✗ White +Q  : -0.426 (expect +0.9, error=1.326)
    ✗ Equal     : -0.313 (expect +0.0, error=0.313)
    Variance: 0.0027 ⚠️  TOO LOW - not learning!
  → No improvement (1/5)

Epoch 7/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 7/30:   7%|▋         | 5/71 [00:00<00:01, 45.85it/s]Epoch 7/30:  14%|█▍        | 10/71 [00:00<00:01, 44.20it/s]Epoch 7/30:  21%|██        | 15/71 [00:00<00:01, 43.11it/s]Epoch 7/30:  28%|██▊       | 20/71 [00:00<00:01, 43.00it/s]Epoch 7/30:  35%|███▌      | 25/71 [00:00<00:01, 42.61it/s]Epoch 7/30:  42%|████▏     | 30/71 [00:00<00:00, 43.31it/s]Epoch 7/30:  49%|████▉     | 35/71 [00:00<00:00, 43.50it/s]Epoch 7/30:  56%|█████▋    | 40/71 [00:00<00:00, 43.35it/s]Epoch 7/30:  63%|██████▎   | 45/71 [00:01<00:00, 44.81it/s]Epoch 7/30:  70%|███████   | 50/71 [00:01<00:00, 43.55it/s]Epoch 7/30:  77%|███████▋  | 55/71 [00:01<00:00, 40.67it/s]Epoch 7/30:  85%|████████▍ | 60/71 [00:01<00:00, 41.16it/s]Epoch 7/30:  92%|█████████▏| 65/71 [00:01<00:00, 40.34it/s]Epoch 7/30:  99%|█████████▊| 70/71 [00:01<00:00, 40.21it/s]Epoch 7/30: 100%|██████████| 71/71 [00:01<00:00, 42.35it/s]
Epoch  7: train=0.2433, val=0.3276
  Testing:
    ✗ Start     : -0.651 (expect +0.0, error=0.651)
    ✗ White +Q  : -0.720 (expect +0.9, error=1.620)
    ✗ Equal     : -0.708 (expect +0.0, error=0.708)
    Variance: 0.0009 ⚠️  TOO LOW - not learning!
  → No improvement (2/5)

Epoch 8/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 8/30:   7%|▋         | 5/71 [00:00<00:01, 40.57it/s]Epoch 8/30:  14%|█▍        | 10/71 [00:00<00:01, 41.95it/s]Epoch 8/30:  21%|██        | 15/71 [00:00<00:01, 44.11it/s]Epoch 8/30:  28%|██▊       | 20/71 [00:00<00:01, 42.80it/s]Epoch 8/30:  35%|███▌      | 25/71 [00:00<00:01, 42.85it/s]Epoch 8/30:  42%|████▏     | 30/71 [00:00<00:00, 42.77it/s]Epoch 8/30:  49%|████▉     | 35/71 [00:00<00:00, 41.86it/s]Epoch 8/30:  56%|█████▋    | 40/71 [00:00<00:00, 43.74it/s]Epoch 8/30:  63%|██████▎   | 45/71 [00:01<00:00, 43.08it/s]Epoch 8/30:  70%|███████   | 50/71 [00:01<00:00, 42.87it/s]Epoch 8/30:  77%|███████▋  | 55/71 [00:01<00:00, 43.07it/s]Epoch 8/30:  85%|████████▍ | 60/71 [00:01<00:00, 41.06it/s]Epoch 8/30:  92%|█████████▏| 65/71 [00:01<00:00, 40.50it/s]Epoch 8/30:  99%|█████████▊| 70/71 [00:01<00:00, 23.22it/s]Epoch 8/30: 100%|██████████| 71/71 [00:01<00:00, 35.62it/s]
Epoch  8: train=0.2327, val=0.3470
  Testing:
    ✗ Start     : -0.454 (expect +0.0, error=0.454)
    ✗ White +Q  : -0.506 (expect +0.9, error=1.406)
    ✗ Equal     : -0.447 (expect +0.0, error=0.447)
    Variance: 0.0007 ⚠️  TOO LOW - not learning!
  → No improvement (3/5)

Epoch 9/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 9/30:   7%|▋         | 5/71 [00:00<00:01, 44.78it/s]Epoch 9/30:  14%|█▍        | 10/71 [00:00<00:01, 45.02it/s]Epoch 9/30:  21%|██        | 15/71 [00:00<00:01, 42.68it/s]Epoch 9/30:  28%|██▊       | 20/71 [00:00<00:01, 43.21it/s]Epoch 9/30:  35%|███▌      | 25/71 [00:00<00:01, 43.29it/s]Epoch 9/30:  42%|████▏     | 30/71 [00:00<00:00, 43.18it/s]Epoch 9/30:  49%|████▉     | 35/71 [00:00<00:00, 41.09it/s]Epoch 9/30:  56%|█████▋    | 40/71 [00:00<00:00, 42.32it/s]Epoch 9/30:  63%|██████▎   | 45/71 [00:01<00:00, 42.87it/s]Epoch 9/30:  70%|███████   | 50/71 [00:01<00:00, 42.83it/s]Epoch 9/30:  77%|███████▋  | 55/71 [00:01<00:00, 42.37it/s]Epoch 9/30:  85%|████████▍ | 60/71 [00:01<00:00, 44.04it/s]Epoch 9/30:  92%|█████████▏| 65/71 [00:01<00:00, 42.58it/s]Epoch 9/30:  99%|█████████▊| 70/71 [00:01<00:00, 41.22it/s]Epoch 9/30: 100%|██████████| 71/71 [00:01<00:00, 42.85it/s]
Epoch  9: train=0.2168, val=0.3674
  Testing:
    ✗ Start     : -0.762 (expect +0.0, error=0.762)
    ✗ White +Q  : -0.800 (expect +0.9, error=1.700)
    ✗ Equal     : -0.760 (expect +0.0, error=0.760)
    Variance: 0.0003 ⚠️  TOO LOW - not learning!
  → No improvement (4/5)

Epoch 10/30:   0%|          | 0/71 [00:00<?, ?it/s]Epoch 10/30:   6%|▌         | 4/71 [00:00<00:01, 39.46it/s]Epoch 10/30:  13%|█▎        | 9/71 [00:00<00:01, 41.03it/s]Epoch 10/30:  20%|█▉        | 14/71 [00:00<00:01, 41.83it/s]Epoch 10/30:  27%|██▋       | 19/71 [00:00<00:01, 42.78it/s]Epoch 10/30:  34%|███▍      | 24/71 [00:00<00:01, 44.88it/s]Epoch 10/30:  41%|████      | 29/71 [00:00<00:00, 45.22it/s]Epoch 10/30:  48%|████▊     | 34/71 [00:00<00:00, 45.09it/s]Epoch 10/30:  55%|█████▍    | 39/71 [00:00<00:00, 43.51it/s]Epoch 10/30:  62%|██████▏   | 44/71 [00:01<00:00, 44.17it/s]Epoch 10/30:  69%|██████▉   | 49/71 [00:01<00:00, 42.53it/s]Epoch 10/30:  76%|███████▌  | 54/71 [00:01<00:00, 43.19it/s]Epoch 10/30:  83%|████████▎ | 59/71 [00:01<00:00, 44.56it/s]Epoch 10/30:  90%|█████████ | 64/71 [00:01<00:00, 44.05it/s]Epoch 10/30:  97%|█████████▋| 69/71 [00:01<00:00, 44.74it/s]Epoch 10/30: 100%|██████████| 71/71 [00:01<00:00, 44.03it/s]
/Users/tahmeed_t/Documents/knight0-training/train_nnue.py:257: DeprecationWarning: You are using the legacy TorchScript-based ONNX export. Starting in PyTorch 2.9, the new torch.export-based ONNX exporter will be the default. To switch now, set dynamo=True in torch.onnx.export. This new exporter supports features like exporting LLMs with DynamicCache. We encourage you to try it and share feedback to help improve the experience. Learn more about the new export logic: https://pytorch.org/docs/stable/onnx_dynamo.html. For exporting control flow: https://pytorch.org/tutorials/beginner/onnx/export_control_flow_model_to_onnx_tutorial.html.
  torch.onnx.export(
Epoch 10: train=0.2040, val=0.4127
  Testing:
    ✗ Start     : -0.736 (expect +0.0, error=0.736)
    ✗ White +Q  : -0.794 (expect +0.9, error=1.694)
    ✗ Equal     : -0.771 (expect +0.0, error=0.771)
    Variance: 0.0006 ⚠️  TOO LOW - not learning!
  → No improvement (5/5)

Early stopping - no improvement for 5 epochs

================================================================================
TRAINING COMPLETE!
================================================================================
Best val loss: 0.3122

Exporting to ONNX...
✓ Exported: nnue_model.onnx (1.5 MB)

Final test:
    ✗ Start     : -0.601 (expect +0.0, error=0.601)
    ✗ White +Q  : -0.655 (expect +0.9, error=1.555)
    ✗ Equal     : -0.606 (expect +0.0, error=0.606)
    Variance: 0.0006 ⚠️  TOO LOW - not learning!

Done! Use nnue_model.onnx in your bot.
